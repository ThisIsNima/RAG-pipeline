

----- Page 1 (native) -----
MIT Open Access Articles
Function and functional redundancy in microbial systems
The MIT Faculty has made this article openly available. Please share
how this access benefits you. Your story matters.
Citation: Louca, Stilianos et al. “Function and Functional Redundancy in Microbial Systems.” 
Nature Ecology & Evolution 2, 6 (April 2018): 936–943 © 2018 Nature Publishing Group
As Published: http://dx.doi.org/10.1038/s41559-018-0519-1
Publisher: Nature Publishing Group
Persistent URL: http://hdl.handle.net/1721.1/119237
Version: Author's final manuscript: final author's manuscript post peer review, without 
publisher's formatting or copy editing
Terms of Use: Article is made available in accordance with the publisher's policy and may be 
subject to US copyright law. Please refer to the publisher's site for terms of use.

----- Page 2 (native) -----
Function and functional redundancy in microbial systems
Stilianos Louca1,2,*, Martin F. Polz3, Florent Mazel1,4,5, Michaeline B. N. Albright6, Julie A. Huber7, Mary I.
O’Connor1,2, Martin Ackermann8,9, Aria S. Hahn10, Diane S. Srivastava1,2, Sean A. Crowe10,11,12, Michael
Doebeli1,2,13 & Laura Wegener Parfrey1,2,4
1Biodiversity Research Centre, University of British Columbia, Canada
2Department of Zoology, University of British Columbia, Canada
3Department of Civil and Environmental Engineering, Massachusetts Institute of Technology, USA
4Department of Botany, University of British Columbia, Canada
5Department of Biological Sciences, Simon Fraser University, Canada
6Department of Ecology and Evolutionary Biology, University of California, Irvine, USA
7Marine Chemistry and Geochemistry, Woods Hole Oceanographic Institution, Woods Hole, MA, USA
8Department of Environmental Systems Science, Eidgenössische Technische Hochschule Zürich, Switzerland
9Department of Environmental Microbiology, Eawag, Switzerland
10Ecosystem Services, Commercialization Platforms, and Entrepreneurship (ECOSCOPE) Training Program,
University of British Columbia, Canada
11Department of Microbiology and Immunology, University of British Columbia, Canada
12Department of Earth, Ocean, and Atmospheric Sciences, University of British Columbia, Canada
13Department of Mathematics, University of British Columbia, Canada
*Corresponding author: louca.research@gmail.com
Abstract
1
Microbial communities often exhibit incredible taxonomic diversity, raising questions regarding the
2
mechanisms enabling species coexistence and the role of this diversity in community functioning. On
3
the one hand, many coexisting but taxonomically distinct microorganisms can encode the same energy-
4
yielding metabolic functions, and this functional redundancy contrasts with the expectation that species
5
should occupy distinct metabolic niches. On the other hand, the identity of taxa encoding each function
6
can vary substantially across space or time with little eﬀect on the function, and this taxonomic variability
7
is frequently thought to result from ecological drift between equivalent organisms. Here we synthesize
8
the powerful paradigm emerging from these two patterns, connecting the roles of function, functional
9
redundancy and taxonomy in microbial systems. We conclude that both patterns are unlikely the result of
10
ecological drift, but are inevitable emergent properties of open microbial systems resulting mainly from
11
biotic interactions and environmental and spatial processes.
12
Keywords: functional redundancy; metabolic niche; microbial community; biogeochemistry
13
14
1

----- Page 3 (native) -----
Introduction
15
Microorganisms are the most ancient, the most phylogenetically diverse and the most widespread form of
16
life on Earth1. A single gram of soil can harbor thousands of microbial species2. The metabolic and biosyn-
17
thetic versatility of microorganisms is equally impressive: the number of discovered prokaryotic protein-
18
coding genes is orders of magnitude greater than those of all plants and animals combined3,4. Metabolic
19
pathways encoded in microorganisms drive the bulk of elemental cycles in most ecosystems, shaping Earth’s
20
surface chemistry over billions of years5. Yet, our mechanistic understanding of microbial systems (mi-
21
crobial communities and coupled abiotic physicochemical processes) remains in its infancy. The enormous
22
microbial diversity presents major challenges to modeling microbial systems and to explaining patterns of
23
community variation across space and time. Moreover, many questions in ecosystem ecology and biogeo-
24
chemistry require knowledge of the variation in microbial metabolic functions, rather than just taxonomic
25
composition. Despite the high microbial diversity, most major biogeochemical reactions are driven by a lim-
26
ited set of energy-transducing metabolic pathways, each of which is found in a variety of microbial clades5.
27
Functional community proﬁling — describing communities in terms of metabolic functions of interest —
28
can simplify microbial systems to a level permissible to mathematical modeling and can reveal patterns of
29
community structuring across environmental gradients6–9. A wave of recent studies in a multitude of envi-
30
ronments, ranging from soil to the ocean and to the human gut9–14, suggest that certain metabolic functions
31
are strongly coupled to certain environmental factors and can, in many cases, appear decoupled from the
32
species assemblages associated with them at a given place and time. Quantiﬁcation of microbial diversity
33
involved in various metabolic functions also revealed that communities typically exhibit high “functional
34
redundancy” with respect to a multitude of functions, in the sense that each metabolic function can be per-
35
formed by multiple coexisting, taxonomically distinct organisms9,13–18. Much confusion exists currently
36
over the meaning of these patterns, however their proper interpretation is paramount to understanding the
37
mechanisms controlling microbial community composition and function. In this synthesis we provide inter-
38
pretations for these patterns and discuss the powerful paradigm emerging from them, uniting the roles that
39
function, functional redundancy and taxonomy play in shaping microbial systems.
40
Disentangling function from taxonomy in microbial communities
41
In one of the ﬁrst comparative metagenomic surveys of microbial communities, Tringe et al. 19 showed that
42
functional proﬁles (in terms of the genes found in communities) were highly correlated with the type of sam-
43
pled environment (seawater vs soil, etc), suggesting that the environment selected for speciﬁc functions. A
44
subsequent comparison of gut microbiota between diﬀerent human hosts revealed that the taxonomic com-
45
position of microbiomes varied strongly across hosts while their community gene content was strongly con-
46
served11. Similarly, in a survey of bacterial communities on the macroalgae Ulva australis, communities
47
appeared to be assembled on the basis of functional genes rather than species12. These ﬁndings suggest that
48
alternative microbial assemblages can exhibit similar community gene proﬁles selected by their environment.
49
In line with this perspective, a recent study of bacterial and archaeal communities inside the foliage “tanks”
50
2

----- Page 4 (native) -----
of bromeliad plants14 found that the functional composition of communities (in terms of genes involved
51
in various energy-transducing functions; Fig. 1C,D) was highly conserved across bromeliads. In contrast,
52
the taxa associated with each functional group (i.e., capable of performing a speciﬁc metabolic function)
53
varied strongly between bromeliads14, regardless of the taxonomic resolution used (up to class level; Fig.
54
1A,B). Hence, the taxonomic composition within functional groups must have been shaped by additional
55
factors that are distinct from the factors shaping the functional structure of communities, that is, taxonomic
56
composition and functional composition (genetic potential) appeared “decoupled”. A similar decoupling
57
between various metabolic functions and taxonomic community composition has been repeatedly observed
58
in experiments with bioreactors, such as for nitrogen removal or methane production, where a high varia-
59
tion in community composition over time coincided with stable bioreactor performance10,15,17,20–23. In the
60
following, we discuss conditions and mechanisms that could promote this frequently observed phenomenon.
61
The contrast between stable functional composition and variable taxonomic composition seen in the afore-
62
mentioned studies10–12,14,15,17,20–23 reﬂects a weak association between many functions and prokaryotic phy-
63
logeny. Indeed, a large fraction of metabolic functions are not monophyletic24,25, that is, no single clade
64
is the sole representative for any of those functions. Thus, while the phylogenetic placement of an organ-
65
ism in principle determines its metabolic potential (given suﬃcient resolution and/or trait conservatism), the
66
reverse need not be true, i.e. metabolic potential is not necessarily indicative of a speciﬁc clade (a notable ex-
67
ception being oxygenic photosynthesis25). Adaptive loss of function or genome streamlining26, convergent
68
evolution, and horizontal gene transfer27 all erode the phylogenetic signal of many traits24. Horizontal gene
69
transfer also leads to low genetic linkage of traits within genomes and hence to reassortment of traits between
70
genomes28. Some Escherichia coli strains, for example, overlap by less than 40% in their protein-coding
71
genes29. The phylogenetic scale at which functions are conserved varies strongly between functions25,30,
72
and even for single functions phylogenetic conservatism can vary between clades (Figs. 2A,B). For example,
73
the ability to respire sulfate is shared by all cultured members of the families Desulfobacteraceae, Desulfo-
74
halobiaceae and Desulfomicrobiaceae, but only by a subset of the genus Archaeoglobus31. Because a given
75
metabolic function may be present and conserved within distinct clades of varying depths, there exists no
76
taxonomic resolution at which taxa either always or never exhibit that function. Consequently, there exists
77
no single taxonomic resolution at which taxonomic variation unambiguously reﬂects functional variation,
78
and at which environmental selection of certain functions (e.g., the presence of oxygen selecting for aerobes)
79
unambiguously translates to a selection of speciﬁc taxa.
80
A partial to complete decoupling of certain functions from particular taxonomic assemblages appears to be
81
almost inevitable, given that the same functions can be performed by alternative taxa (Fig. 2C). Nutrient sup-
82
ply rates, irradiance, geochemical gradients, environmental transport processes and stoichiometric balances
83
between pathways across organisms can strongly constrain reaction rates, and energy yields from metabolic
84
pathways further aﬀect the possible growth rates of functional groups8,32,33. While each function can of
85
course only be performed by certain taxa, the aforementioned factors may exert little control over which of
86
those taxa perform each function in a particular situation. Reciprocally, bulk biochemical ﬂux rates may
87
exhibit low sensitivity to taxonomic changes within functional groups over space or time. In support of this
88
3

----- Page 5 (native) -----
interpretation, a global biogeographical study in soil found that abiotic soil characteristics largely explained
89
the variation in the abundances of nitrogen cycling pathways, but only weakly explained the taxonomic com-
90
position within the corresponding functional groups13. Similar observations have also been made for a broad
91
range of metabolic functions across the global ocean6,9. Reciprocally, a recent meta-analysis found that an in-
92
clusion of taxonomic community composition, in addition to environmental variables, as predictors of carbon
93
and nitrogen process rates only improved predictive power in 29% of considered studies, with the adjusted R2
94
only increasing from 0.56 to 0.65 on average34. Which functions are strongly controlled by the environment
95
— thus being less sensitive to taxonomic variation — depends on the type of ecosystem, and in particular on
96
the redox disequilibria available for energy gain and the physical-chemical boundary conditions. In experi-
97
ments, broadly distributed functions such as respiration, overall carbon catabolism and biomass production
98
often appear more resistant to changes in taxonomic community composition or diversity, than narrow func-
99
tions such as the degradation of speciﬁc compounds35–38. A possible reason for this pattern is that broad
100
functions may be more functionally redundant and thus better buﬀered against taxonomic shifts caused by
101
biotic or abiotic disturbance39. Thermodynamically favored endpoints of linear catabolic pathways may be
102
less sensitive to taxonomic variation than individual intermediate steps that can be performed in alternative
103
ways. For example, models for methanogenic bioreactors fed continuously with glucose suggest that the rel-
104
ative ﬂux rates through “alternative” catabolic pathways (e.g., the various alternative routes from glucose to
105
volatile fatty acids and eventually to methane; Fig. 3A) may be less stable in the face of taxonomic shifts,
106
than the overall methane production rate40.
107
Some studies have observed strong correlations between functional and taxonomic community composi-
108
tion, for example across strong redox gradients41. We emphasize that when environmental conditions vary,
109
selection for speciﬁc metabolic functions will generally cause changes in taxonomic community composi-
110
tion in addition to the taxonomic variation occurring within functional groups. Therefore, when comparing
111
communities over space or time, the correlation between functional and taxonomic community composition
112
will depend on the relative importance of mechanisms selecting for speciﬁc functions versus mechanisms
113
causing variation within functional groups (discussed below), as well as on the phylogenetic distribution of
114
those functions.
115
We point out that functional community structure can in principle be deﬁned with respect to any arbitrary
116
set of functions (and observed spatiotemporal patterns will depend on the choice of functions), although par-
117
ticular attention is typically devoted to energy-transducing metabolic functions involved in major elemental
118
cycles5 or of particular industrial importance17. We also mention that some authors deﬁne “functional re-
119
sponse groups”, i.e. organisms that respond similarly to speciﬁc environmental factors, and distinguish those
120
from “functional eﬀect groups”, i.e. organisms with a similar eﬀect on speciﬁc ecosystem functions42. Here
121
we avoid this terminology, however, partly because (metabolic) functional groups (sensu this synthesis) can
122
usually be seen both as eﬀect groups and as response groups. Further, as discussed above, metabolic function
123
and taxonomic variation within functional groups constitute complementary and disentangled facets of many
124
microbial systems, and can yield insight into markedly diﬀerent processes9,14.
125
4

----- Page 6 (native) -----
Functional redundancy is an omnipresent feature of open microbial systems
126
A large fraction of metabolic genes appeared early in Earth’s history27 and, as discussed above, over geologi-
127
cal time propagated into multiple microbial clades5,27. Today, at global scales, most metabolic functions can
128
be potentially performed by a wide range of extant taxa. More strikingly, even at local scales, the enumeration
129
of taxa associated with each metabolic function, either by taxonomic binning of metagenomic sequences13
130
or by functional classiﬁcation of taxa9, often reveals a coexistence of multiple distinct organisms capable
131
of performing similar metabolic functions9,13–18,39,43. For example, hundreds of microorganisms capable
132
of hydrogen oxidation can coexist in groundwater18, and hundreds of oxygenic photoautotrophs can coexist
133
in the ocean surface9,44. In a sub-seaﬂoor aquifer, dozens of genomes had the potential to oxidize sulﬁde
134
for energy and at least 15 genomes were capable of complete denitriﬁcation43. In methanogenic digesters
135
cellulose hydrolysis can be concurrently performed by dozens of diﬀerent organisms17. In nitrifying biore-
136
actors, typically multiple ammonia oxidizing bacteria coexist and exhibit variable relative abundances over
137
time15,16. Functional redundancy, it seems, is a common aspect of many microbial systems. That said, it is
138
clear that the degree of functional redundancy in any given system depends on the function considered. In
139
the sunlit and oxygen-rich ocean surface, for example, photoautotrophy and oxygen respiration are generally
140
much more redundant than sulfate respiration and methanogenesis9.
141
Functional community structure (and thus functional redundancy) could in principle be deﬁned at vari-
142
ous levels of detail, for example further diﬀerentiating functions based on reaction kinetics. Some authors
143
consider organisms functionally redundant only if they can readily replace each other due to high ecologi-
144
cal similarity45, although the same authors acknowledge that this criterion is rarely met in practice. Other
145
authors only deﬁne organisms as redundant if they are able to perform a function at the same rate, given the
146
same environmental conditions46. The latter requirement can be hard to test in practice, and sequencing data
147
rarely allow inference of enzyme kinetics beyond the type of reactions potentially catalyzed. The practicality
148
of such a deﬁnition is also limited by the fact that the metabolic activity of a population depends on the overall
149
community state, such as the presence of syntrophic partners, phages or bacteriocins. Moreover, bulk pro-
150
cess rates could be largely constrained by physicochemical characteristics of the environment, such as spatial
151
transport rates across sediment columns or substrate supply rates in bioreactors. Populations of distinct taxa
152
with diﬀerent reaction kinetics may thus induce diﬀerent or similar biochemical ﬂux rates, depending on the
153
detailed environmental setup and the current state of the community. We thus argue that a deﬁnition of func-
154
tional redundancy indicating the mere ability of multiple distinct organisms to perform a speciﬁc function, as
155
used in this synthesis and as observed in many environments, is of greater practical relevance than the more
156
stringent deﬁnitions by Fuhrman et al. 45 or by Allison et al. 46. For example, functional redundancy (sensu
157
this synthesis) is often linked to the stability of functions against environmental perturbations39 and, as we
158
discuss below, can yield insight into important community processes.
159
5

----- Page 7 (native) -----
Mechanisms promoting functional redundancy
160
A high functional redundancy with respect to energy-transducing metabolic pathways has long been ob-
161
served in macrobial communities47. Almost all plants, for example, share a common metabolic niche —
162
they are oxygenic photoautotrophs. In microbes and macrobes alike, functional redundancy indicates that
163
additional factors beyond the mere availability of diﬀerent energy sources must be controlling diversity. In-
164
deed, Tilman’s classical competition theory48,49 asserts that at steady state and in a well-mixed system any
165
given resource — such as an electron donor or acceptor — can only be limiting to at most a single persisting
166
population. This population will be the one that can maintain a steady size at the lowest possible resource
167
level, since all other populations are either outcompeted or limited by a diﬀerent resource. While steady
168
state and perfect mixing arguably represent an idealized situation, Tilman’s competition theory provides a
169
benchmark — a minimum expectation — to which observed diversity can be compared. The apparent dis-
170
connect between the theoretical expectation of one species persisting per limiting resource, and the observed
171
diversity of life has been explained for macrobial communities in several ways47. First, spatial and temporal
172
heterogeneity either in the identity of the limiting resource or in environmental conditions, combined with
173
response diﬀerences between species, may eﬀectively create multiple niches. Second, competitive exclusion
174
can be disrupted by biotic interactions such as predation, or be oﬀset by dispersal from a regional pool. Im-
175
portantly, species may show tradeoﬀs between traits involved in resource competition, and traits involved in
176
environmental tolerance, predator resistance or dispersal47.
177
Similarly to macroorganisms, functional redundancy in microbial communities may be promoted by dif-
178
ferentiation along other niche axes than just metabolic resources, including diﬀerences in their response to
179
environmental perturbations, diﬀerences in attachment strategies to particles17, diﬀerences in chemotactic
180
strategies for exploring nutrient gradients and ﬁnding food particles50,51, diﬀerences in the number and types
181
of lyase genes for speciﬁc polysaccharides (e.g., alginate)28, ﬂuctuating nutrient concentrations combined
182
with diﬀerent growth kinetics52, limitation by diﬀerent trace nutrients53 and predation by phages and pro-
183
tist grazers54,55. Trade-oﬀs between nutrient acquisition and resistance to phage predation56, for example,
184
may enable coexistence of competitors57, although the precise eﬀects of phages on microbial communities
185
remain uncertain55,58. Intransitive competitive dynamics, whereby multiple pairs of competing species col-
186
lectively have no clear winner, may also play a role via antibiotic warfare59,60. It is likely that metabolically
187
overlapping microorganisms diﬀerentiate ecologically in many more ways that we can currently identify, and
188
hence community assembly takes place in a high-dimensional (multifactorial) space. Indeed, recent gene
189
cataloging eﬀorts across microbial genomes revealed hundreds of thousands of gene clusters with largely
190
uncharacterized function3. In view of these observations, functional redundancy almost seems like an in-
191
evitable outcome in open microbial systems — systems where diversity is not limited by low immigration
192
rates.
193
Care must be taken when assessing the metabolic niche utilized by an organism solely based on its
194
metabolic potential, e.g., inferred from its genome. Populations with a similar metabolic repertoire (“funda-
195
mental” metabolic niche61) may specialize on distinct nutrients, thus exhibiting separate “realized” niches
196
that may be expressed at the transcriptional level51,62. In particular, a functional group may appear as highly
197
6

----- Page 8 (native) -----
redundant even if only a few members actively perform that function at a time, since some members can
198
exhibit alternative modes to gain energy while others may simply be inactive. The metabolic functions
199
performed by a given population generally depends on environmental conditions as well as on the pres-
200
ence and activity of other community members58. We emphasize that the predictions of classical compe-
201
tition theory, discussed above, still apply even if organisms in a community are metabolically multifunc-
202
tional. That is, at steady state the number of coexisting organisms cannot exceed the number of resources
203
(including metabolic byproducts) limiting the growth of at least one organism49. For example, while two
204
hydrogenotrophic methanogens may coexist in the same environment, at steady state they cannot be limited
205
by the same hydrogen pool. Fine-scale spatial segregation in a non-well-mixed environment is one possible
206
mechanism enabling coexistence. For example, organisms with similar nutritional preferences can reside and
207
obtain their nutrients within distinct bioﬁlms and can thus co-exist at larger scales51. In these cases, however,
208
it is important to realize that populations in distinct bioﬁlms do not compete for the same nutrient pools and
209
thus have distinct realized niches.
210
Functional redundancy does not imply neutrality
211
Loreau hypothesized that functional redundancy within a metabolic niche may reﬂect quasi-neutral coexis-
212
tence of competitors63. However, as discussed above, coexisting microorganisms specializing on the same
213
energy source not only typically diﬀer in terms of their enzyme eﬃciencies and growth kinetics, but also
214
in other traits inﬂuencing their growth rates under speciﬁc conditions. While diﬀerences between members
215
of a functional group are generally acknowledged, controversy exists as to whether certain patterns of mi-
216
crobial community assembly may nevertheless be explained by neutral processes64,65. In analogy to neutral
217
theories from macrobial ecology66, Sloan et al. 67 developed a neutral model for local microbial community
218
assembly based solely on stochastic immigration and ecological drift (ﬂuctuations due to the stochasticity
219
of birth/death events in ﬁnite populations), while omitting speciation — a common element of macrobial
220
neutral theories. Sloan et al. 67 concluded that stochastic immigration and ecological drift are important
221
factors in shaping prokaryotic communities, particularly within metabolic functional groups67,68. Following
222
Sloan et al. 67, neutral models have been used to partly explain microbial biogeographical patterns in diverse
223
environments, including animal guts69, soil70, bioreactors71, tree holes72 and bioﬁlms73. It has also been
224
suggested that ecological drift within functional groups may partly explain species turnover over time, for
225
example in bioreactors74,75, in subsurface waters76 and in stream catchments77.
226
We emphasize that complex or apparently stochastic changes in taxonomic composition within functional
227
groups, even in closed systems, should not be confused for ecological drift. In fact, ecological drift is rarely
228
a valid explanation for taxonomic turnover within functional groups, as observed for example in bioreactors
229
over time15,17,74,75. This is because the importance of ecological drift, in contrast to selection processes,
230
diminishes at large population sizes and/or large ecological diﬀerences between competitors78,79. In biore-
231
actors and most natural environments, cell densities can be extremely high (up to 1013 cells · L−1 in biore-
232
actors80) to the point that selection processes would clearly dominate over ecological drift. Indeed, neutral
233
stochastic birth-death models predict that even at low population sizes (104 cells), it would take a relatively
234
7

----- Page 9 (native) -----
rare organism (1% proportion) in a community consisting of equal competitors on average over 1,600 days
235
to reach a proportion of 30% solely via ecological drift (based on a generation time of 1 day40). When
236
even a weak competitive advantage is assumed for one of the organisms (5% higher expected growth rate),
237
both populations closely follow the deterministic trajectory predicted from competitive exclusion (fraction
238
of explained variance 0.98 ± 0.02 s.d.; Supplement S.1). Hence, the eﬀect of drift on population trajectories
239
becomes negligible even under weak competitive diﬀerences. We note that the above model parameters are
240
quite conservative. Indeed, microbial populations typically comprise more than 104 cells and it is not uncom-
241
mon to observe extremely rare taxa (< 0.1% proportion) replacing previously dominant and metabolically
242
similar taxa within just a few weeks, even under constant environmental conditions10,15,22,75. Moreover, even
243
strains of the same species can exhibit vastly diﬀerent substrate aﬃnities (e.g., up to 400% diﬀerence81) or
244
distinct susceptibilities to specialist phages55,58. Consequently, the probability that competitors have suﬃ-
245
ciently similar growth rates over a suﬃcient period of time for drift to be a noticeable driver of taxonomic
246
turnover is extremely low. Hence, while functional redundancy — either at a local or regional scale —
247
is a necessary condition for taxonomic turnover within functional groups, turnover itself is generally not
248
explained by ecological drift. Consistent with this prediction, a recent large-scale analysis of human mi-
249
crobiomes82 found that fewer than 1% of communities satisﬁed Hubbel’s neutral theory of biodiversity66.
250
Similarly, a survey of bromeliad microbiomes found that assembly within functional groups was far from
251
neutral, despite their constant functional structure, high functional redundancies and highly variable taxo-
252
nomic composition between bromeliads14. Even in plant and animal ecology, where population sizes are
253
much lower than in typical microbial communities, clear evidence for a strong role of ecological drift (e.g.,
254
compared to selection) is rare79.
255
Since ecological drift generally can’t explain taxonomic turnover within functional groups, this turnover
256
must result from ecological diﬀerences between members of a functional group and, potentially, dispersal
257
processes. Previous studies indeed suggested limited dispersal as an important source of taxonomic varia-
258
tion between sites, based on random phylogenetic structure of early colonists during succession83, increasing
259
taxonomic richness over time in semi-open incubations84, or — more commonly — a decay of community
260
similarity with increasing geographical distance85,86. The latter studies remain inconclusive, however, be-
261
cause a distance decay in community similarity can also be caused by spatially correlated environmental
262
heterogeneity. For example, accounting for environmental heterogeneity was found to explain all or most
263
of the correlation between distance and microbial community dissimilarity in salt marshes87, in the global
264
ocean9 and between bromeliads14. Environmental heterogeneity is generally hard to rule out as a cause of
265
spatial variation of taxonomic community composition without thorough environmental measurements.
266
In experiments with replicate bioreactors operated under constant conditions, microbial community com-
267
position followed complex but reproducible trajectories over periods ranging from weeks to months20,22,88.
268
This suggests that taxonomic turnover within functional groups in the absence of obvious environmental
269
variation can be driven by intrinsic and at least partly deterministic processes. Such intrinsic processes may
270
include “killing-the-winner” type phage-host-interactions, where specialist phages repeatedly induce the col-
271
lapse of dominant microbial populations, although experimental evidence for this mechanism remains rare89.
272
8

----- Page 10 (native) -----
Other proposed mechanisms include antibiotic warfare59,60, rapid evolution of cross-feeding90 and adaptive
273
niche construction91. Every species may thus be aﬀected by a distinct combination of biotic and abiotic fac-
274
tors that modulate its instantaneous growth rate, even if its metabolic potential overlaps with other members
275
of the community45. These factors may be frequency-dependent and may include a stochastic component,
276
for example due to mutations or horizontal gene transfer events. In practice, chaotic population dynamics92
277
may obscure the distinction between deterministic and stochastic assembly processes. Further, at regional
278
scales infrequent dispersal may add stochasticity to community assembly in a way that cannot be explained
279
by intrinsic dynamics alone. Hence, even if all environmental factors were known at a speciﬁc moment in
280
time, taxonomic community composition may not be perfectly predictable.
281
Conclusions
282
Frequently perceived as an indication of neutral assembly, functional redundancy is actually a manifesta-
283
tion of the ecological diversity of microorganisms capable of a particular metabolic function. Functional
284
redundancy is an inevitable emergent property of open microbial systems that becomes visible when a high-
285
dimensional trait space is projected to a lower-dimensional function space of interest. It may thus be seen
286
as a partial measure of diversity, namely diversity within functional groups, that is mathematically comple-
287
mentary to functional richness of a community, just as the taxonomic composition within functional groups
288
can be considered complementary to functional community structure9,14. We speculate that the degree of
289
functional redundancy in open microbial systems may be a stabilized systemic property that is largely deter-
290
mined by the type of environment and the functions considered. This hypothesis may be particularly true for
291
natural systems with continuous exposure to immigration, such as the open ocean, where a balance between
292
immigration and local extinction could determine functional redundancy at ecological time scales.
293
Depending on the choice of functions, a distinction between functional community structure and compo-
294
sition within functional groups can yield important insight into biogeochemistry and community assembly
295
mechanisms. Indeed, metabolic pathways involved in energy transduction can be strongly coupled to certain
296
environmental factors and elemental cycles5–7,33 and can appear decoupled from particular taxonomic as-
297
semblages10,14,77. Similar observations are known from macrobial ecology93, which has had a long history
298
of describing community structure in terms of guilds, lifeforms and strategies, all of which may be consid-
299
ered analogous to metabolic functional groups in microbes. More recently, there have been calls to entirely
300
abandon modeling macroscopic communities in terms of species, but instead to focus on functional traits94.
301
Reducing microbial communities to energy-transducing metabolic functions, and investigating functional
302
redundancy with respect to these functions, may thus also be a fruitful approach for microbial ecology.
303
Beyond metabolic niche eﬀects, several additional mechanisms, such as predation and antibiotic warfare,
304
can modulate the taxonomic composition of microbial communities over space and time, even if the activity
305
of certain metabolic functions is strongly conserved. It is clear that this apparent decoupling between function
306
and taxonomy is not the simple result of stochastic ecological drift within functional groups. How and under
307
which conditions various mechanisms lead to this decoupling, and what determines the extent of functional
308
9

----- Page 11 (native) -----
redundancy in microbial systems, are becoming central questions in ecology.
309
10

----- Page 12 (native) -----
Glossary
•
functional group
The set of taxa potentially capable of performing a speciﬁc biochemical func-
tion, e.g., based on their genetic content.
•
functional richness
(of a community) Number of focal biochemical functions or genes present.
•
functional redundancy
(with respect to a given function) The coexistence of multiple distinct taxa or
genomes capable of performing the same focal biochemical function.
•
functional structure
(of a community) Relative abundances of various focal functional groups, or
of genes associated with focal functions.
•
ecological drift
Fluctuations in relative population sizes due to the stochastic nature of birth-
death events in ﬁnite populations79.
•
metabolic niche
(in an ecosystem) The ability for organisms to gain energy for growth using a
speciﬁc metabolic pathway (e.g., H2/CO2 methanogenesis) or half-reaction
(e.g., use of a speciﬁc electron acceptor for respiration).
•
metabolic niche eﬀects
(on community assembly) Mechanisms selecting for organisms able to exploit
speciﬁc metabolic niches. Such mechanisms may include the availability of
light for photosynthesis, or of sulfate as an electron acceptor for respiration.
•
microbial system
A microbial community, its metabolites in the extracellular environment and
bidirectionally coupled abiotic physicochemical processes, including physi-
cal transport processes and abiotic chemical reactions. Analogous to “ecosys-
tem”, but focusing on microbial members instead of macrobial food webs.
Acknowledgements
310
We thank Matthew Pennell, Ford Doolittle, Adam C. Martiny and Ilan Rubin for discussions and for par-
311
ticipation at a workshop from which this synthesis emerged. We thank the Canadian Institute for Ecology
312
and Evolution (CIEE) for ﬁnancial support of all authors, by means of a Thematic Working group grant on
313
the “Evolution of microbial metabolic and genomic diversity at multiple scales”. We thank the Biodiver-
314
sity Research Centre and the Adapting Biosystems program, University of British Columbia, for ﬁnancial
315
support and Katie Beall for logistical support. S.L. was supported by an NSERC grant, and a postdoctoral
316
fellowship from the Biodiversity Research Centre, UBC. J.A.H. was supported by the NSF Center for Dark
317
Energy Biosphere Investigations (OCE-0939564).
318
Author contributions
319
S.L., L.W.P. and M.D. organized the workshop from which this synthesis emerged. S.L. performed the data
320
analyses. All authors contributed to the writing of the manuscript.
321
11

----- Page 13 (native) -----
Competing interests
322
The authors declare that they have no competing interests.
323
Additional information
324
Correspondence and requests for materials should be addressed to S.L. Supporting text and tables, cited in
325
the text, are provided as Supplementary Material.
326
References
327
[1] Hug, L.A. et al. A new view of the tree of life. Nat. Microbiol. 1, 16048 EP (2016).
328
[2] Gans, J., Wolinsky, M. & Dunbar, J. Computational improvements reveal great bacterial diversity and
329
high metal toxicity in soil. Science 309, 1387–1390 (2005).
330
[3] Powell, S. et al. eggnog v4.0: nested orthology inference across 3686 organisms. Nucleic Acids Res.
331
42, D231–D239 (2014).
332
[4] O’Leary, N.A. et al. Reference sequence (RefSeq) database at NCBI: current status, taxonomic ex-
333
pansion, and functional annotation. Nucleic Acids Res. 44, D733 (2016).
334
[5] Falkowski, P.G., Fenchel, T. & Delong, E.F. The microbial engines that drive Earth’s biogeochemical
335
cycles. Science 320, 1034–1039 (2008).
336
[6] Raes, J., Letunic, I., Yamada, T., Jensen, L.J. & Bork, P. Toward molecular trait-based ecology through
337
integration of biogeochemical, geographical and metagenomic data. Mol. Syst. Biol. 7, 473 (2011).
338
[7] Reed, D.C., Algar, C.K., Huber, J.A. & Dick, G.J. Gene-centric approach to integrating environmental
339
genomics and biogeochemical models. Proc. Natl. Acad. Sci. USA 111, 1879–1884 (2014).
340
[8] Louca, S. et al. Integrating biogeochemistry with multiomic sequence information in a model oxygen
341
minimum zone. Proc. Natl. Acad. Sci. USA 113, E5925–E5933 (2016).
342
[9] Louca, S., Parfrey, L.W. & Doebeli, M. Decoupling function and taxonomy in the global ocean mi-
343
crobiome. Science 353, 1272–1277 (2016).
344
[10] Fernández, A. et al. How stable is stable? Function versus community composition. Appl. Environ.
345
Microbiol. 65, 3697–3704 (1999).
346
[11] Turnbaugh, P.J. et al. A core gut microbiome in obese and lean twins. Nature 457, 480–484 (2009).
347
[12] Burke, C., Steinberg, P., Rusch, D., Kjelleberg, S. & Thomas, T. Bacterial community assembly based
348
on functional genes rather than species. Proc. Natl. Acad. Sci. USA 108, 14288–14293 (2011).
349
12

----- Page 14 (native) -----
[13] Nelson, M.B., Martiny, A.C. & Martiny, J.B.H. Global biogeography of microbial nitrogen-cycling
350
traits in soil. Proc. Natl. Acad. Sci. USA 113, 8033–8040 (2016).
351
[14] Louca, S. et al. High taxonomic variability despite stable functional structure across microbial com-
352
munities. Nat. Ecol. Evol. 1, 0015 (2016).
353
[15] Wittebolle, L., Vervaeren, H., Verstraete, W. & Boon, N. Quantifying community dynamics of nitri-
354
ﬁers in functionally stable reactors. Appl. Environ. Microbiol. 74, 286–293 (2008).
355
[16] Wells, G.F. et al. Ammonia-oxidizing communities in a highly aerated full-scale activated sludge
356
bioreactor: betaproteobacterial dynamics and low relative abundance of crenarchaea. Environ. Mi-
357
crobiol. 11, 2310–2328 (2009).
358
[17] Vanwonterghem, I., Jensen, P.D., Rabaey, K. & Tyson, G.W. Genome-centric resolution of microbial
359
diversity, metabolism and interactions in anaerobic digestion. Environ. Microbiol. 18, 3144–3158
360
(2016).
361
[18] Anantharaman, K. et al. Thousands of microbial genomes shed light on interconnected biogeochem-
362
ical processes in an aquifer system. Nat. Commun. 7, 13219 EP (2016).
363
[19] Tringe, S.G. et al. Comparative metagenomics of microbial communities. Science 308, 554–557
364
(2005).
365
[20] Kaewpipat, K. & Grady, C. Microbial population dynamics in laboratory-scale activated sludge reac-
366
tors. Water Sci. Technol. 46, 19–27 (2002).
367
[21] Wang, X. et al. Bacterial community dynamics in a functionally stable pilot-scale wastewater treatment
368
plant. Bioresour. Technol. 102, 2352–2357 (2011).
369
[22] Fernandez-Gonzalez, N., Huber, J.A. & Vallino, J.J.
Microbial communities are well adapted to
370
disturbances in energy input. mSystems 1, e00117–16 (2016).
371
[23] Sheng, Y. et al. Geochemical and temporal inﬂuences on the enrichment of acidophilic iron-oxidizing
372
bacterial communities. Appl. Environ. Microbiol. 82, 3611–3621 (2016).
373
[24] Aguilar, D., Aviles, F.X., Querol, E. & Sternberg, M.J.E. Analysis of phenetic trees based on metabolic
374
capabilites across the three domains of life. J. Mol. Biol. 340, 491–512 (2004).
375
[25] Martiny, J.B.H., Jones, S.E., Lennon, J.T. & Martiny, A.C. Microbiomes in light of traits: A phylo-
376
genetic perspective. Science 350 (2015).
377
[26] Morris, J.J., Lenski, R.E. & Zinser, E.R. The black queen hypothesis: evolution of dependencies
378
through adaptive gene loss. MBio 3, e00036–12 (2012).
379
[27] David, L.A. & Alm, E.J. Rapid evolutionary innovation during an archaean genetic expansion. Nature
380
469, 93–96 (2011).
381
13

----- Page 15 (native) -----
[28] Hehemann, J.H. et al. Adaptive radiation by waves of gene transfer leads to ﬁne-scale resource parti-
382
tioning in marine microbes. Nat. Commun. 7, 12860 EP (2016).
383
[29] Welch, R.A. et al.
Extensive mosaic structure revealed by the complete genome sequence of
384
uropathogenic Escherichia coli. Proc. Natl. Acad. Sci. USA 99, 17020–17024 (2002).
385
[30] Martiny, A.C., Treseder, K. & Pusch, G. Phylogenetic conservatism of functional traits in microor-
386
ganisms. ISME J. 7, 830–838 (2013).
387
[31] Whitman, W.B. (ed.) Bergey’s Manual of Systematics of Archaea and Bacteria (John Wiley & Sons,
388
Inc., Hoboken, New Jersey, 2015).
389
[32] Canﬁeld, D.E. & Thamdrup, B. Towards a consistent classiﬁcation scheme for geochemical environ-
390
ments, or, why we wish the term ‘suboxic’ would go away. Geobiol. 7, 385–392 (2009).
391
[33] Reed, D.C. et al. Predicting the response of the deep-ocean microbiome to geochemical perturbations
392
by hydrothermal vents. ISME J. 9, 1857–1869 (2015).
393
[34] Graham, E.B. et al. Microbes as engines of ecosystem function: When does community structure
394
enhance predictions of ecosystem processes? Front. Microbiol. 7, 214 (2016).
395
[35] Girvan, M.S., Campbell, C.D., Killham, K., Prosser, J.I. & Glover, L.A. Bacterial diversity promotes
396
community stability and functional resilience after perturbation.
Environ. Microbiol. 7, 301–313
397
(2005).
398
[36] Langenheder, S., Lindström, E.S. & Tranvik, L.J. Weak coupling between community composition
399
and functioning of aquatic bacteria. Limnol. Oceanogr. 50, 957–967 (2005).
400
[37] Langenheder, S., Lindström, E.S. & Tranvik, L.J. Structure and function of bacterial communities
401
emerging from diﬀerent sources under identical conditions. Appl. Environ. Microbiol. 72, 212–220
402
(2006).
403
[38] Peter, H. et al. Function-speciﬁc response to depletion of microbial diversity. ISME J. 5, 351–361
404
(2011).
405
[39] Jurburg, S.D. & Salles, J.F. Functional Redundancy and Ecosystem Function – The Soil Microbiota
406
as a Case Study, chap. 2, 29–49 (INTECH, 2015).
407
[40] Louca, S. & Doebeli, M. Taxonomic variability and functional stability in microbial communities
408
infected by phages. Environ. Microbiol. 19, 3863–3878 (2017).
409
[41] Hawley, A.K., Brewer, H.M., Norbeck, A.D., Paša-Tolić, L. & Hallam, S.J. Metaproteomics reveals
410
diﬀerential modes of metabolic coupling among ubiquitous oxygen minimum zone microbes. Proc.
411
Natl. Acad. Sci. USA 111, 11395–11400 (2014).
412
[42] Lavorel, S. & Garnier, E. Predicting changes in community composition and ecosystem functioning
413
from plant traits: revisiting the holy grail. Funct. Ecol. 16, 545–556 (2002).
414
14

----- Page 16 (native) -----
[43] Tully, B., Wheat, C.G., Glazer, B.T. & Huber, J. A dynamic microbial community with high functional
415
redundancy inhabits the cold, oxic subseaﬂoor aquifer. ISME J. 12, 1–16 (2017).
416
[44] Kashtan, N. et al.
Single-cell genomics reveals hundreds of coexisting subpopulations in wild
417
Prochlorococcus. Science 344, 416–420 (2014).
418
[45] Fuhrman, J.A., Cram, J.A. & Needham, D.M.
Marine microbial community dynamics and their
419
ecological interpretation. Nat. Rev. Micro. 13, 133–146 (2015).
420
[46] Allison, S.D. & Martiny, J.B.H. Resistance, resilience, and redundancy in microbial communities.
421
Proc. Natl. Acad. Sci. USA 105, 11512–11519 (2008).
422
[47] Chesson, P. Mechanisms of maintenance of species diversity. Annu. Rev. Ecol. Syst. 31, 343–366
423
(2000).
424
[48] Tilman, D. Resource Competition and Community Structure (Princeton University Press, Princeton,
425
NJ, 1982).
426
[49] Freter, R., Brickner, H., Botney, M., Cleven, D. & Aranki, A. Mechanisms that control bacterial
427
populations in continuous-ﬂow culture models of mouse large intestinal ﬂora. Infect. Immun. 39,
428
676–685 (1983).
429
[50] Yawata, Y. et al. Competition–dispersal tradeoﬀecologically diﬀerentiates recently speciated marine
430
bacterioplankton populations. Proc. Natl. Acad. Sci. USA 111, 5622–5627 (2014).
431
[51] Pereira, F.C. & Berry, D. Microbial nutrient niches in the gut. Environ. Microbiol. (2017).
432
[52] Sommer, U. The paradox of the plankton: Fluctuations of phosphorus availability maintain diversity
433
of phytoplankton in ﬂow-through cultures. Limnol. Oceanogr. 29, 633–636 (1984).
434
[53] Moore, C. et al. Processes and patterns of oceanic nutrient limitation. Nat. Geosci. 6, 701 (2013).
435
[54] Wildschutte, H., Wolfe, D.M., Tamewitz, A. & Lawrence, J.G. Protozoan predation, diversifying
436
selection, and the evolution of antigenic diversity in salmonella. Proc. Natl. Acad. Sci. USA 101,
437
10644–10649 (2004).
438
[55] Rodriguez-Valera, F. et al. Explaining microbial population genomics through phage predation. Nat.
439
Rev. Microbiol. 7, 828–836 (2009).
440
[56] Bohannan, B.J.M., Kerr, B., Jessup, C.M., Hughes, J.B. & Sandvik, G. Trade-oﬀs and coexistence in
441
microbial microcosms. Antonie Leeuwenhoek 81, 107–115 (2002).
442
[57] Chesson, P. & Kuang, J.J. The interaction between predation and competition. Nature 456, 235–238
443
(2008).
444
[58] Cordero, O.X. & Polz, M.F. Explaining microbial genomic diversity in light of evolutionary ecology.
445
Nat. Rev. Microbiol. 12, 263–273 (2014).
446
15

----- Page 17 (native) -----
[59] Czárán, T.L., Hoekstra, R.F. & Pagie, L. Chemical warfare between microbes promotes biodiversity.
447
Proc. Natl. Acad. Sci. USA 99, 786–790 (2002).
448
[60] Hibbing, M.E., Fuqua, C., Parsek, M.R. & Peterson, S.B. Bacterial competition: surviving and thriv-
449
ing in the microbial jungle. Nat. Rev. Micro. 8, 15–25 (2010).
450
[61] Hutchinson, G. Concluding remarks. In Cold Spring Harbour Symposium in Quantitative Biology,
451
vol. 22, 415–427 (1957).
452
[62] Plichta, D.R. et al. Transcriptional interactions suggest niche segregation among microorganisms in
453
the human gut. Nat. Microbiol. 1, 16152 EP – (2016).
454
[63] Loreau, M. Does functional redundancy exist? Oikos 104, 606–611 (2004).
455
[64] Curtis, T.P. & Sloan, W.T. Prokaryotic diversity and its limits: microbial community structure in
456
nature and implications for microbial ecology. Curr. Opin. Microbiol. 7, 221 – 226 (2004).
457
[65] Konopka, A., Lindemann, S. & Fredrickson, J. Dynamics in microbial communities: unraveling
458
mechanisms to identify principles. ISME J. 9, 1488–1495 (2015).
459
[66] Hubbell, S.P. The Uniﬁed Neutral Theory of Biodiversity and Biogeography, vol. 32 (Princeton Uni-
460
versity Press, 2001).
461
[67] Sloan, W.T. et al. Quantifying the roles of immigration and chance in shaping prokaryote community
462
structure. Environ. Microbiol. 8, 732–740 (2006).
463
[68] Sloan, W.T., Woodcock, S., Lunn, M., Head, I.M. & Curtis, T.P. Modeling taxa-abundance distri-
464
butions in microbial communities using environmental sequence data. Microb. Ecol. 53, 443–455
465
(2007).
466
[69] Burns, A.R. et al. Contribution of neutral processes to the assembly of gut microbial communities in
467
the zebraﬁsh over host development. ISME J. (2015).
468
[70] Dumbrell, A.J., Nelson, M., Helgason, T., Dytham, C. & Fitter, A.H. Relative roles of niche and
469
neutral processes in structuring a soil microbial community. ISME J. 4, 337–345 (2009).
470
[71] Curtis, T., Polchan, M., Baptista, J., Davenport, R. & Sloan, W. Microbial community assembly,
471
theory and rare functions. Front. Microbiol. 4, 68 (2013).
472
[72] Woodcock, S. et al. Neutral assembly of bacterial communities. FEMS Microbiol. Ecol. 62, 171–180
473
(2007).
474
[73] Woodcock, S. & Sloan, W.T. Bioﬁlm community succession: a neutral perspective. Microbiology
475
163, 664–668 (2017).
476
[74] Ayarza, J.M. & Erijman, L. Balance of neutral and deterministic components in the dynamics of
477
activated sludge ﬂoc assembly. Microb. Ecol. 61, 486–495 (2010).
478
16

----- Page 18 (native) -----
[75] Oﬁţeru, I.D. et al. Combined niche and neutral eﬀects in a microbial wastewater treatment community.
479
Proc. Natl. Acad. Sci. USA 107, 15345–15350 (2010).
480
[76] Stegen, J.C., Lin, X., Konopka, A.E. & Fredrickson, J.K.
Stochastic and deterministic assembly
481
processes in subsurface microbial communities. ISME J. 6, 1653–1664 (2012).
482
[77] Frossard, A., Gerull, L., Mutz, M. & Gessner, M.O. Disconnect of microbial structure and function:
483
enzyme activities and bacterial communities in nascent stream corridors. ISME J. 6, 680–691 (2012).
484
[78] Lande, R., Engen, S. & Sæther, B. Stochastic Population Dynamics in Ecology and Conservation.
485
Oxford series in ecology and evolution (Oxford University Press, 2003).
486
[79] Vellend, M. Conceptual synthesis in community ecology. Q. Rev. Biol. 85, 183–206 (2010).
487
[80] Krakat, N., Westphal, A., Schmidt, S. & Scherer, P. Anaerobic digestion of renewable biomass: Ther-
488
mophilic temperature governs methanogen population dynamics. Appl. Environ. Microbiol. 76, 1842–
489
1850 (2010).
490
[81] Ohtsubo, S. et al. Comparison of acetate utilization among strains of an aceticlastic methanogen,
491
Methanothrix soehngenii. Appl. Environ. Microbiol. 58, 703–705 (1992).
492
[82] Li, L. & Ma, Z.S. Testing the neutral theory of biodiversity with human microbiome datasets. Scientiﬁc
493
Reports 6, 31448 (2016).
494
[83] Dini-Andreote, F., Stegen, J.C., van Elsas, J.D. & Salles, J.F. Disentangling mechanisms that mediate
495
the balance between stochastic and deterministic processes in microbial succession. Proc. Natl. Acad.
496
Sci. USA 112, E1326–E1332 (2015).
497
[84] Albright, M.B.N. & Martiny, J.B.H. Dispersal alters bacterial diversity and composition in a natural
498
community. ISME J. – (2017).
499
[85] Martiny, J.B.H. et al. Microbial biogeography: putting microorganisms on the map. Nat. Rev. Micro-
500
biol. 4, 102–112 (2006).
501
[86] Martiny, J.B.H., Eisen, J.A., Penn, K., Allison, S.D. & Horner-Devine, M.C. Drivers of bacterial
502
β-diversity depend on spatial scale. Proc. Natl. Acad. Sci. USA 108, 7850–7854 (2011).
503
[87] Horner-Devine, M.C., Lage, M., Hughes, J.B. & Bohannan, B.J. A taxa–area relationship for bacteria.
504
Nature 432, 750–753 (2004).
505
[88] Vanwonterghem, I. et al. Deterministic processes guide long-term synchronised population dynamics
506
in replicate anaerobic digesters. ISME J. 8, 2015–2028 (2014).
507
[89] Shapiro, O.H. & Kushmaro, A. Bacteriophage ecology in environmental biotechnology processes.
508
Curr. Opin. Biotechnol. 22, 449–455 (2011).
509
17

----- Page 19 (native) -----
[90] Herron, M.D. & Doebeli, M. Parallel evolutionary dynamics of adaptive diversiﬁcation in Escherichia
510
coli. PLoS Biol. 11, e1001490 (2013).
511
[91] Callahan, B.J., Fukami, T. & Fisher, D.S. Rapid evolution of adaptive niche construction in experi-
512
mental microbial populations. Evolution 68, 3307–3316 (2014).
513
[92] Graham, D.W. et al. Experimental demonstration of chaotic instability in biological nitriﬁcation.
514
ISME J. 1, 385–393 (2007).
515
[93] Fukami, T., Martijn Bezemer, T., Mortimer, S.R. & Putten, W.H. Species divergence and trait conver-
516
gence in experimental plant community assembly. Ecol. Lett. 8, 1283–1290 (2005).
517
[94] McGill, B.J., Enquist, B.J., Weiher, E. & Westoby, M. Rebuilding community ecology from functional
518
traits. Trends Ecol. Evol. 21, 178–185 (2006).
519
[95] Parks, D.H., Imelfort, M., Skennerton, C.T., Hugenholtz, P. & Tyson, G.W. Assessing the quality of
520
microbial genomes recovered from isolates, single cells, and metagenomes. Genome Res. 25, 1043–
521
1055 (2014).
522
[96] Mistry, J., Finn, R.D., Eddy, S.R., Bateman, A. & Punta, M. Challenges in homology search: HM-
523
MER3 and convergent evolution of coiled-coil regions. Nucleic Acids Res. 41, e121 (2013).
524
[97] Haft, D.H. et al. TIGRFAMs and genome properties in 2013. Nucleic Acids Res. 41, D387 (2013).
525
[98] Finn, R.D. et al. The pfam protein families database. Nucleic Acids Res. 36, D281 (2008).
526
[99] Quast, C. et al. The SILVA ribosomal RNA gene database project: improved data processing and
527
web-based tools. Nucleic Acids Res. 41, D590–D596 (2013).
528
[100] Louca, S. & Doebeli, M. Eﬃcient comparative phylogenetics on large trees. Bioinformatics (2017).
529
18

----- Page 20 (native) -----
families
OTUs
B1
B2
B3 B4
B5
B6 B7
B8 B12 B14 B15B17 B18 B19 B20 B21 B27 B28 B29 B30B32 B33
B1
B2
B3 B4
B5
B6 B7
B8 B12 B14 B15B17 B18 B19 B20 B21 B27 B28 B29 B30B32 B33
KEGG gene categories (level C)
metabolic gene groups (custom)
fermentation
oxygen respiration
carbon ﬁxation
A
B
C
D
bromeliad
bromeliad
gene proportions
OTU or taxon proportions
Figure 1: Gene-centric structure of microbial communities can decouple from taxonomic composition. (A,B)
Relative abundances of bacterial and archaeal families (A) and OTUs (B; at 99% 16S gene similarity), found in the
foliage of 22 similar and concurrently sampled Aechmea nudicaulis bromeliads in Juruba Tiba National Park, Brazil14
(one column per bromeliad, one color per taxon). (C,D) Corresponding metagenomic community composition in terms
of KEGG standard categories (C) and custom metabolic gene groups (D), as deﬁned in14 (one column per sample, one
color per gene group). Note the more variable taxonomic composition across bromeliads (A, B), compared to the
relatively conserved metagenomic composition (C, D).
19

----- Page 21 (native) -----
number of genomes
positive clades per function
number of genomes
mean phylogenetic depth
(subst. per site)
B
C
metabolic function
A
Figure 2: Phylogenetic conservatism varies between functions and between clades. (A) Schematic illustration of
a phylogenetic tree, where ﬁlled and empty tips indicate the presence and absence, respectively, of a speciﬁc function.
Depending on the location in the tree, a function may be conserved in deep or shallow clades (dashed circles). (B)
Prokaryotic clades positive in various metabolic functions (i.e. with the function present in ≥95% of tips), represented
as circles (one circle per positive clade per function). Circles are positioned on the horizontal axis according to the
clade’s mean phylogenetic depth. Larger circles correspond to clades containing more tips (logarithmic scale). The
majority of functions are conserved in a multitude of clades of variable depths and sizes, with oxygenic photosynthesis
being a notable exception. Thus, for most functions there exists no taxonomic resolution at which taxa either always
or never exhibit that function. (C) Number of non-redundant prokaryotic genomes (i.e., with unique NCBI taxon IDs),
downloaded from NCBI RefSeq4 and found to exhibit each function. B and C are based on genes detected in ∼59,000
nearly-complete sequenced genomes. See Methods for details.
20

----- Page 22 (native) -----
cellulose
glucose
formate
H2/CO2
a
acetate
methane
NO−
3
NH+
4
A
C
hydrolysis
fermentation
methanogenesis
cellulose
glucose
methane
B
formate
H2/CO2
a
acetate
Figure 3: Functional redundancy in methanogenic communities (schematic illustration). (A) Illustration of a
typical metabolic network spanned by microbial communities in methanogenic cellulose-fed bioreactors, driving the
catabolism of cellulose to methane. Circles represent substrates or end-products, and edge color indicates the associated
substrate. (B) Expansion of each catabolic step, showing multiple distinct organisms capable of performing the same
reaction. Filled dots represent distinct population genomes. Schematic illustration of roughly analogous ﬁndings by
Vanwonterghem et al. 17. (C) Focus on 3 seemingly redundant organisms, catabolizing glucose to acetate. Realized
niche diﬀerentiation and coexistence can be enabled by trait diﬀerences beyond the type of substrates used, potentially
including susceptibility to diﬀerent phages (blue vs purple), diﬀerent strategies for foraging, attachment to particles
and bioﬁlm formation, diﬀerent nitrogen pools used (nitrate NO−
3 vs ammonium NH+
4 ), as well as production and
resistance to diﬀerent antibiotics (small pentagons).
21

----- Page 23 (native) -----
Methods
530
Phylogenetic distribution of metabolic functions
531
To examine the phylogenetic distribution of various metabolic functions (Figs. 2B,C), we proceeded as de-
532
scribed below. Unless otherwise mentioned, all online ﬁles were downloaded on September 12, 2017. A
533
total of 92,315 sequenced prokaryotic genomes with a completion status “Complete Genome”, “Contig” or
534
“Scaﬀold”, and a gap fraction not greater than 1%, were downloaded from NCBI RefSeq4. Downloaded
535
genomes were further checked for completeness and contamination with checkM 1.0.695, using the option
536
“reduced_tree”. Genomes estimated to be less than 98% complete, exhibiting a contamination level above
537
1%, exhibiting a strain heterogeneity above 1% or lacking a protein prediction ﬁle (ﬁles protein.faa, pro-
538
vided by NCBI), were discarded, leaving us with 59,092 nearly-complete genomes for downstream analysis.
539
In each genome, we used Hidden Markov Models (HMMs) and hmmsearch v3.1b296 to search for proteins
540
associated with various metabolic functions, such as photosynthesis or methanogenesis. HMMs were ob-
541
tained from the Jillian Banﬁeld lab GitHub page (https://github.com/banfieldlab)18, the TIGRFAM
542
database v15.097 and the Pfam protein database v30.098. Pre-calibrated noise cutoﬀvalues (included in each
543
HMM) and a maximum E-value of 10−50 were used as hit criterion for each HMM. For some functions, mul-
544
tiple proteins were used as alternative proxies for the function, while for other functions multiple proteins
545
had to be all present for the function. Proteins used as proxies for each function and corresponding HMM
546
accession numbers are listed in Table S1.
547
Each prokaryotic OTU in the SILVA NR99 small subunit ribosomal RNA database (release 12899) was
548
mapped to one of the genomes whenever possible, based on the ID of the NCBI taxonomy project (“taxid”)
549
provided by SILVA (ﬁle https://www.arb-silva.de/no_cache/download/archive/release_128/
550
Exports/taxmap_embl_ssu_ref_128.txt.gz) and the taxid provided by NCBI for each genome (ta-
551
ble ftp://ftp.ncbi.nlm.nih.gov/genomes/genbank/*/assembly_summary.txt, where “*” is ei-
552
ther “bacteria or “archaea”). A total of 54,043 OTUs could be mapped to a genome. A phylogenetic tree
553
was constructed for the mapped OTUs by pruning the oﬃcial SILVA NR99 tree. For each mapped OTU, we
554
assumed a metabolic function to be present if it was found to be present in the mapped genome. To deter-
555
mine the clades within which a particular function was conserved (Fig. 2B), we proceeded as follows: We
556
traversed the tree from the root to the tips in breadth-ﬁrst search mode until reaching a node whose descend-
557
ing clade was positive in the function (i.e. where the function was present in at least 95% of descending tips),
558
recording the mean phylogenetic depth of the clade (average distance of the node to its tips) and the total size
559
of the clade (total number of descending tips). All descending tips and nodes were subsequently excluded
560
from the remainder of the traversal, and traversal continued with the next node in the traversal queue. Thus,
561
every positive clade recorded (and plotted in Fig. 2B) was maximal, in the sense that it was not part of any
562
bigger positive clade. Single positive tips with no positive sister tip were not counted, because in that case no
563
information was available on the phylogenetic depth at which the function is locally conserved. Occasional
564
positive clades with a mean phylogenetic depth below 1% are not shown in Fig. 2B, since OUTs in SILVA are
565
oﬃcially resolved at 1% dissimilarity. The above analysis has been implemented in the R package castor,
566
22

----- Page 24 (native) -----
function get_trait_depth100.
567
To calculate the number of non-redundant genomes exhibiting a particular function (Fig. 2C), i.e. account-
568
ing for the fact that some RefSeq genomes are genomes of the same strains or very closely related strains,
569
we only counted genomes with a unique NCBI taxid. Among the 59,092 genomes, there were 22,660 unique
570
taxids. We emphasize that the number of genomes per function shown in Fig. 2C should not be compared
571
between functions, due to biases in the types of prokaryotes represented in RefSeq.
572
23